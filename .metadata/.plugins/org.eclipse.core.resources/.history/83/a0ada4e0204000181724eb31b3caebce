package edu.uqam.inf5153.tp3.application.session;

import java.io.IOException;
import java.security.NoSuchAlgorithmException;

import javax.security.auth.login.LoginContext;
import javax.security.auth.login.LoginException;

import edu.uqam.inf5153.tp3.domaine.ControlleurLogin;
import edu.uqam.inf5153.tp3.fondation.CryptWithSalt;

/*
 * Le code suivant est inspir√© de 
 * https://www.youtube.com/watch?v=xv2xltxnnBU
 * 
 * */
public class Session {
	private String utilisateur = "";
	private String motPasse;
	public String getUtilisateur(){
		return utilisateur;
	}
	public String getMotPasse(){
		return motPasse;
	}
	public void setUtilisateur(String u){
		utilisateur = u;
	}
	public void setMotPasse(char[] pwd){
		String hash1 = "";
		String hash2 = "aa";
		CryptWithSalt encoder1 = CryptWithSalt.getInstance();
	        try {
				hash1 = encoder1.encode(pwd.toString());
			} catch (NoSuchAlgorithmException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			} catch (IOException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
	        System.out.println(hash1);

	        // Assume the same present in db
	        CryptWithSalt encoder2 = CryptWithSalt.getInstance();
	        try {
				hash2 = encoder2.encode(pwd.toString()) + "aaa";
			} catch (NoSuchAlgorithmException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			} catch (IOException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
	        System.out.println(hash2);

	        if(hash1.equalsIgnoreCase(hash2))
	            System.out.println("Both hash Matches..");
	        else
	            System.out.println("Hash matches fails..");
		
	
		
	}
	public Session(){
		
	
	}
	
	
	public boolean authentifier(){
		return true;
	}

/*	
	public boolean authentifier(){
		System.setProperty("java.security.auth.login.config", "DossierMedical.config");
		LoginContext login = null;
		try {
			login = new LoginContext("DossierMedicalConfig", new ControlleurLogin());
		} catch (LoginException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
	//	while(true){
			try{
				login.login();
				return true;
			}catch(LoginException e){
				//System.out.println(e.getMessage());
				return false;
			}
		}
	//}
*/
}
